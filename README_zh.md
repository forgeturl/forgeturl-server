<p align="center">
  <h1 align="center">ğŸ”– ForgetURL Server</h1>
  <p align="center">
    <strong>æç®€ä¹¦ç­¾ç®¡ç†æœåŠ¡ - è®©é“¾æ¥æ”¶è—å˜å¾—ç®€å•</strong>
  </p>
  <p align="center">
    <a href="#åŠŸèƒ½ç‰¹æ€§">åŠŸèƒ½ç‰¹æ€§</a> â€¢
    <a href="#å¿«é€Ÿå¼€å§‹">å¿«é€Ÿå¼€å§‹</a> â€¢
    <a href="#api-æ–‡æ¡£">API æ–‡æ¡£</a> â€¢
    <a href="#éƒ¨ç½²æŒ‡å—">éƒ¨ç½²æŒ‡å—</a>
  </p>
  <p align="center">
    <a href="./README.md">ğŸ‡¬ğŸ‡§ English</a>
  </p>
</p>

---

## ğŸ“– é¡¹ç›®ç®€ä»‹

ForgetURL æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ä¹¦ç­¾ç®¡ç†å¹³å°ï¼Œå¸®åŠ©ç”¨æˆ·è½»æ¾ä¿å­˜ã€æ•´ç†å’Œåˆ†äº«ç½‘é¡µé“¾æ¥ã€‚é€šè¿‡ç®€æ´ä¼˜é›…çš„ç•Œé¢å’Œå¼ºå¤§çš„åç«¯æœåŠ¡ï¼Œè®©é“¾æ¥æ”¶è—ä¸å†ç¹çã€‚

**ä¸ºä»€ä¹ˆé€‰æ‹© ForgetURLï¼Ÿ**

- ğŸ¯ **æç®€è®¾è®¡** - ä¸“æ³¨äºæ ¸å¿ƒåŠŸèƒ½ï¼Œæ‹’ç»è‡ƒè‚¿
- ğŸ” **å®‰å…¨å¯é ** - æ”¯æŒå¤šç§ç¬¬ä¸‰æ–¹ OAuth ç™»å½•
- ğŸ”— **çµæ´»åˆ†äº«** - å¤šçº§æƒé™æ§åˆ¶ï¼Œæ»¡è¶³ä¸åŒåˆ†äº«åœºæ™¯
- ğŸ“¦ **æ— ç¼è¿ç§»** - æ”¯æŒä¹¦ç­¾å¯¼å…¥/å¯¼å‡ºï¼Œè½»æ¾è¿ç§»æ•°æ®

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ” ç”¨æˆ·è®¤è¯
- æ”¯æŒ Googleã€GitHub ç­‰ç¬¬ä¸‰æ–¹ OAuth ç™»å½•
- å®‰å…¨çš„ Token è®¤è¯æœºåˆ¶
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†

### ğŸ“„ é¡µé¢ç®¡ç†
- **åˆ›å»ºé¡µé¢** - å¿«é€Ÿåˆ›å»ºä¹¦ç­¾æ”¶è—é¡µ
- **ç¼–è¾‘é¡µé¢** - æ”¯æŒæ ‡é¢˜ã€æè¿°ã€é“¾æ¥é›†åˆçš„å®æ—¶ç¼–è¾‘
- **åˆ é™¤é¡µé¢** - å®‰å…¨åˆ é™¤ä¸éœ€è¦çš„é¡µé¢
- **æ’åºé¡µé¢** - è‡ªå®šä¹‰é¡µé¢é¡ºåº

### ğŸ“ é“¾æ¥ç»„ç»‡
- **é“¾æ¥é›†åˆ** - å°†ç›¸å…³é“¾æ¥åˆ†ç»„ç®¡ç†
- **æ ‡ç­¾ç³»ç»Ÿ** - ä¸ºé“¾æ¥æ·»åŠ æ ‡ç­¾ï¼Œä¾¿äºç­›é€‰
- **å­é“¾æ¥** - æ”¯æŒä¸»é“¾æ¥ä¸‹æŒ‚è½½ç›¸å…³å­é“¾æ¥

### ğŸ”— æƒé™åˆ†äº«
| é“¾æ¥ç±»å‹ | å‰ç¼€ | æƒé™è¯´æ˜ |
|---------|------|---------|
| åªè¯»é“¾æ¥ | `R` | ä»…å¯æŸ¥çœ‹ï¼Œæ— æ³•ç¼–è¾‘ |
| ç¼–è¾‘é“¾æ¥ | `E` | å¯æŸ¥çœ‹å’Œç¼–è¾‘å†…å®¹ |
| è¶…çº§æƒé™ | `A` | å®Œå…¨æ§åˆ¶æƒé™ |

### ğŸ“¥ æ•°æ®å¯¼å…¥/å¯¼å‡º
- æ”¯æŒä»æµè§ˆå™¨å¯¼å…¥ä¹¦ç­¾
- æ”¯æŒå¯¼å‡ºä¸ºé€šç”¨æ ¼å¼

## ğŸ›  æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ |
|-----|------|
| **è¯­è¨€** | Go 1.23 |
| **Web æ¡†æ¶** | Gin |
| **ORM** | GORM + Gen |
| **æ•°æ®åº“** | MySQL |
| **ç¼“å­˜** | Redis |
| **API è§„èŒƒ** | Protocol Buffers / gRPC |
| **å®¹å™¨åŒ–** | Docker |
| **è®¤è¯** | Goth (OAuth) |

## ğŸ“ é¡¹ç›®ç»“æ„

```
forgeturl-server/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/                    # API å±‚
â”‚   â”‚   â”œâ”€â”€ proto/              # Protobuf å®šä¹‰æ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ space.proto     # ç©ºé—´ç®¡ç† API
â”‚   â”‚   â”‚   â”œâ”€â”€ login.proto     # ç™»å½•è®¤è¯ API
â”‚   â”‚   â”‚   â””â”€â”€ dumplinks.proto # æ•°æ®å¯¼å…¥å¯¼å‡º API
â”‚   â”‚   â”œâ”€â”€ space/              # ç”Ÿæˆçš„ç©ºé—´æœåŠ¡ä»£ç 
â”‚   â”‚   â”œâ”€â”€ login/              # ç”Ÿæˆçš„ç™»å½•æœåŠ¡ä»£ç 
â”‚   â”‚   â””â”€â”€ docs/               # Swagger æ–‡æ¡£
â”‚   â”œâ”€â”€ cmd/                    # å‘½ä»¤è¡Œå…¥å£
â”‚   â”œâ”€â”€ conf/                   # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ dal/                    # æ•°æ®è®¿é—®å±‚
â”‚   â”‚   â”œâ”€â”€ model/              # æ•°æ®æ¨¡å‹
â”‚   â”‚   â””â”€â”€ query/              # GORM Gen æŸ¥è¯¢
â”‚   â”œâ”€â”€ pkg/                    # å…¬å…±åŒ…
â”‚   â”‚   â”œâ”€â”€ connector-google/   # Google OAuth è¿æ¥å™¨
â”‚   â”‚   â”œâ”€â”€ core/               # æ ¸å¿ƒå·¥å…·
â”‚   â”‚   â”œâ”€â”€ lcache/             # æœ¬åœ°ç¼“å­˜
â”‚   â”‚   â”œâ”€â”€ maths/              # æ•°å­¦å·¥å…·ï¼ˆIDç”Ÿæˆï¼‰
â”‚   â”‚   â””â”€â”€ middleware/         # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ route/                  # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ main.go                 # ä¸»å…¥å£
â”‚   â””â”€â”€ go.mod                  # Go æ¨¡å—å®šä¹‰
â”œâ”€â”€ tests/                      # æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ Dockerfile                  # Docker æ„å»ºæ–‡ä»¶
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.23+
- MySQL 5.7+
- Redis 6.0+

### æœ¬åœ°å¼€å‘

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/your-username/forgeturl.git
cd forgeturl/forgeturl-server

# 2. å®‰è£…ä¾èµ–
cd app
go mod download

# 3. é…ç½®ç¯å¢ƒ
cp conf/local.toml.example conf/local.toml
# ç¼–è¾‘ conf/local.toml é…ç½®æ•°æ®åº“å’Œ Redis è¿æ¥

# 4. å¯åŠ¨æœåŠ¡
go run main.go api start
```

æœåŠ¡é»˜è®¤è¿è¡Œåœ¨ `http://127.0.0.1:80`

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t forgeturl-server .

# è¿è¡Œå®¹å™¨
docker run -d -p 80:80 forgeturl-server
```

## ğŸ“š API æ–‡æ¡£

### è®¤è¯æœºåˆ¶

æ‰€æœ‰éœ€è¦ç™»å½•æ€çš„æ¥å£éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ Tokenï¼š

```http
X-Token: your_access_token
```

### æ ¸å¿ƒæ¥å£

#### ç©ºé—´ç®¡ç†

| æ¥å£ | æ–¹æ³• | è¯´æ˜ | ç™»å½•æ€ |
|-----|------|-----|-------|
| `/space/getUserInfo` | POST | è·å–ç”¨æˆ·ä¿¡æ¯ | å¯é€‰ |
| `/space/getMySpace` | POST | è·å–æˆ‘çš„ç©ºé—´ | âœ… |
| `/space/getPage` | POST | è·å–é¡µé¢è¯¦æƒ… | å¯é€‰ |
| `/space/createPage` | POST | åˆ›å»ºé¡µé¢ | âœ… |
| `/space/updatePage` | POST | æ›´æ–°é¡µé¢ | âœ… |
| `/space/deletePage` | POST | åˆ é™¤é¡µé¢ | âœ… |
| `/space/savePageIds` | POST | ä¿å­˜é¡µé¢æ’åº | âœ… |
| `/space/addPageLink` | POST | ç”Ÿæˆåˆ†äº«é“¾æ¥ | âœ… |
| `/space/removePageLink` | POST | ç§»é™¤åˆ†äº«é“¾æ¥ | âœ… |

#### ç™»å½•è®¤è¯

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|-----|
| `/auth/{provider}` | GET | OAuth æˆæƒè·³è½¬ |
| `/callback/{provider}` | GET | OAuth å›è°ƒå¤„ç† |
| `/login/logout` | POST | ç™»å‡º |

#### æ•°æ®å¯¼å…¥å¯¼å‡º

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|-----|
| `/dumplinks/importBookmarks` | POST | å¯¼å…¥ä¹¦ç­¾ |
| `/dumplinks/exportBookmarks` | POST | å¯¼å‡ºä¹¦ç­¾ |

### è¯·æ±‚ç¤ºä¾‹

<details>
<summary><b>è·å–ç”¨æˆ·ä¿¡æ¯</b></summary>

```bash
curl 'http://127.0.0.1:80/space/getUserInfo' \
  -d '{"uid": 1}' \
  -H 'Content-Type: application/json'
```
</details>

<details>
<summary><b>è·å–æˆ‘çš„ç©ºé—´</b></summary>

```bash
curl 'http://127.0.0.1:80/space/getMySpace' \
  -d '{}' \
  -H 'Content-Type: application/json' \
  -H 'X-Token: your_token'
```
</details>

<details>
<summary><b>åˆ›å»ºé¡µé¢</b></summary>

```bash
curl 'http://127.0.0.1:80/space/createPage' \
  -d '{
    "title": "æˆ‘çš„ä¹¦ç­¾",
    "brief": "å¸¸ç”¨é“¾æ¥æ”¶è—",
    "collections": [
      {
        "title": "å¼€å‘å·¥å…·",
        "links": [
          {
            "title": "GitHub",
            "url": "https://github.com",
            "tags": ["ä»£ç ", "å¼€æº"]
          }
        ]
      }
    ]
  }' \
  -H 'Content-Type: application/json' \
  -H 'X-Token: your_token'
```
</details>

<details>
<summary><b>æ›´æ–°é¡µé¢</b></summary>

```bash
curl 'http://127.0.0.1:80/space/updatePage' \
  -d '{
    "page_id": "O3sFmpq",
    "title": "æ›´æ–°åçš„æ ‡é¢˜",
    "brief": "æ›´æ–°åçš„æè¿°",
    "collections": [...],
    "version": 0,
    "mask": 7
  }' \
  -H 'Content-Type: application/json' \
  -H 'X-Token: your_token'
```

**æ›´æ–°æ©ç  (mask) è¯´æ˜ï¼š**
- `0x01` (1): æ›´æ–°æ ‡é¢˜
- `0x02` (2): æ›´æ–°æè¿°
- `0x04` (4): æ›´æ–°é›†åˆ
- `0x07` (7): æ›´æ–°æ‰€æœ‰å­—æ®µ
</details>

<details>
<summary><b>ç”Ÿæˆåˆ†äº«é“¾æ¥</b></summary>

```bash
curl 'http://127.0.0.1:80/space/addPageLink' \
  -d '{
    "page_id": "O3sFmpq",
    "page_type": "readonly"
  }' \
  -H 'Content-Type: application/json' \
  -H 'X-Token: your_token'
```

**page_type é€‰é¡¹ï¼š**
- `readonly` - åªè¯»é“¾æ¥
- `edit` - å¯ç¼–è¾‘é“¾æ¥
- `admin` - è¶…çº§æƒé™é“¾æ¥
</details>

## ğŸŒ ç¯å¢ƒé…ç½®

é¡¹ç›®æ”¯æŒä¸‰ä¸ªè¿è¡Œç¯å¢ƒï¼š

| ç¯å¢ƒ | é…ç½®æ–‡ä»¶ | API åœ°å€ |
|-----|---------|---------|
| æœ¬åœ°å¼€å‘ | `local.toml` | `http://127.0.0.1:80` |
| æµ‹è¯•ç¯å¢ƒ | `test.toml` | `https://test-api.brightguo.com` |
| ç”Ÿäº§ç¯å¢ƒ | `onl.toml` | `https://api.brightguo.com` |

## ğŸ”§ å¼€å‘æŒ‡å—

### ä»£ç ç”Ÿæˆ

```bash
# ç”Ÿæˆ API ä»£ç ï¼ˆä» proto æ–‡ä»¶ï¼‰
./genapi.sh

# ç”Ÿæˆ GORM æ¨¡å‹å’ŒæŸ¥è¯¢
cd dal && ./gensql.sh
```

### è¿è¡Œæµ‹è¯•

```bash
cd tests
pip install -r requirements.txt
python run_tests.py
```

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

<p align="center">
  Made with â¤ï¸ by ForgetURL Team
</p>
